---
title: Development
description: Development workflows, troubleshooting, and contributing to LegalEase AI.
navigation:
  icon: i-lucide-code
---

This guide covers development workflows, debugging, testing, and troubleshooting for LegalEase AI.

## Development Setup

Set up LegalEase AI for local development.

### Prerequisites

Ensure you have installed:
- [mise](https://mise.jdx.dev/) - Task runner and environment manager
- Docker Engine 24.0+ with Docker Compose V2
- Git for version control
- A code editor (VS Code recommended)

### Initial Setup

1. **Clone and enter the repository:**
   ```bash
   git clone https://github.com/AlliecatOwO/legalease-ai.git
   cd legalease-ai
   ```

2. **Start services:**
   ```bash
   mise run up
   ```

3. **Initialize database:**
   ```bash
   mise run migrate
   ```

4. **Download AI models:**
   ```bash
   mise run setup:models
   ```

## Common Commands

LegalEase AI uses mise for task automation. Run `mise tasks` to see all available commands.

### Service Management

```bash
# Start all services
mise run up

# Stop all services
mise run down

# Restart services
mise run restart

# Rebuild and restart
mise run rebuild

# Check service status
mise run ps

# Clean everything (removes all data!)
mise run clean
```

### Viewing Logs

```bash
# View all logs
mise run logs

# Backend logs only
mise run logs:backend

# Worker logs only
mise run logs:worker

# Frontend logs only
mise run logs:frontend

# Follow logs in real-time
mise run logs -f
```

### Database Operations

```bash
# Run migrations
mise run migrate

# Create new migration
DESCRIPTION="add user table" mise run migrate:create

# Rollback one migration
mise run migrate:down

# View migration history
mise run migrate:history

# Open PostgreSQL shell
mise run psql
```

### Testing

```bash
# Run all tests
mise run test

# Run tests with coverage report
mise run test:cov

# Run specific test file
pytest backend/tests/test_search.py

# Run tests matching pattern
pytest -k "test_hybrid"
```

### Shell Access

```bash
# Backend container shell
mise run shell

# Frontend container shell
mise run shell:frontend

# Worker container shell
docker exec -it legalease-worker bash
```

### Data Seeding

```bash
# Seed database with sample data
mise run seed

# Clear and reseed database
mise run seed:clear
```

## Local Development (Without Docker)

For faster iteration, you can run services locally without Docker.

### Backend Development

```bash
# Install Python dependencies (requires Python 3.11+)
cd backend
pip install -e ".[dev]"

# Run development server with hot reload
mise run dev-backend

# Alternative: use uvicorn directly
uvicorn app.main:app --reload --port 8000
```

### Frontend Development

```bash
# Install Node.js dependencies
cd frontend
npm install

# Run development server with hot module replacement
mise run dev-frontend

# Alternative: use nuxt directly
npm run dev
```

### Worker Development

```bash
# Run Celery worker locally
cd backend
mise run dev-worker

# Alternative: run celery directly
celery -A app.worker worker --loglevel=info
```

**Note**: You still need Docker for databases (PostgreSQL, Qdrant, Neo4j, Redis, MinIO, Ollama).

## Code Structure

Understanding the codebase organization.

### Backend Structure

```
backend/
├── app/
│   ├── api/              # API endpoints
│   │   └── endpoints/    # Route handlers
│   ├── core/             # Core configuration
│   ├── db/               # Database models and session
│   ├── models/           # SQLAlchemy models
│   ├── schemas/          # Pydantic schemas
│   ├── services/         # Business logic
│   │   ├── search.py     # Hybrid search implementation
│   │   ├── processing.py # Document processing
│   │   ├── transcription.py # Audio transcription
│   │   └── entities.py   # Entity extraction
│   ├── worker.py         # Celery worker configuration
│   └── main.py           # FastAPI application
├── tests/                # Test files
├── alembic/              # Database migrations
└── requirements.txt      # Python dependencies
```

### Frontend Structure

```
frontend/
├── app/
│   ├── components/       # Vue components
│   │   ├── search/       # Search-related components
│   │   ├── documents/    # Document viewer components
│   │   └── common/       # Shared components
│   ├── pages/            # Nuxt pages (routes)
│   ├── layouts/          # Page layouts
│   ├── composables/      # Vue composables
│   ├── stores/           # Pinia stores (state management)
│   ├── utils/            # Utility functions
│   └── assets/           # Static assets
├── public/               # Public static files
└── nuxt.config.ts        # Nuxt configuration
```

## Debugging

Tips for debugging common issues.

### Backend Debugging

**Enable verbose logging:**
```bash
# backend/.env
LOG_LEVEL=DEBUG
```

**Use Python debugger:**
```python
# Insert breakpoint in code
import pdb; pdb.set_trace()

# Or use ipdb for better experience
import ipdb; ipdb.set_trace()
```

**Debug API requests:**
```bash
# View request/response details
curl -v http://localhost:8000/api/search?query=test

# Use httpie for prettier output
http http://localhost:8000/api/search query==test
```

### Frontend Debugging

**Vue DevTools:**
1. Install Vue DevTools browser extension
2. Open browser DevTools
3. Navigate to Vue tab
4. Inspect components, stores, and events

**Console logging:**
```javascript
// Add debug logs
console.log('Search query:', searchQuery.value)
console.table(searchResults.value)
```

**Network inspection:**
1. Open browser DevTools
2. Navigate to Network tab
3. Monitor API calls and responses

### Worker Debugging

**View worker logs:**
```bash
mise run logs:worker
```

**Monitor task queue:**
```bash
# Install and run Flower
celery -A app.worker flower --port=5555

# Access at http://localhost:5555
```

**Debug tasks:**
```python
# Run task synchronously for debugging
from app.tasks import process_document
result = process_document.apply(args=[document_id])
```

## Testing

Writing and running tests.

### Backend Testing

LegalEase AI uses pytest for backend testing.

**Run tests:**
```bash
# All tests
pytest

# With coverage
pytest --cov=app --cov-report=html

# Specific test file
pytest tests/test_search.py

# Specific test function
pytest tests/test_search.py::test_hybrid_search

# Stop on first failure
pytest -x

# Show print statements
pytest -s
```

**Writing tests:**
```python
# tests/test_search.py
import pytest
from app.services.search import hybrid_search

def test_hybrid_search():
    results = hybrid_search(query="contract breach", limit=10)
    assert len(results) > 0
    assert results[0].score > 0

@pytest.fixture
def sample_document(db_session):
    # Create test data
    doc = Document(title="Test", content="Test content")
    db_session.add(doc)
    db_session.commit()
    return doc
```

### Frontend Testing

Frontend testing uses Vitest and Testing Library.

**Run tests:**
```bash
# All tests
npm run test

# Watch mode
npm run test:watch

# UI mode
npm run test:ui
```

**Writing tests:**
```javascript
// components/SearchBar.test.js
import { describe, it, expect } from 'vitest'
import { mount } from '@vue/test-utils'
import SearchBar from './SearchBar.vue'

describe('SearchBar', () => {
  it('emits search event on submit', async () => {
    const wrapper = mount(SearchBar)
    const input = wrapper.find('input')
    await input.setValue('test query')
    await wrapper.find('form').trigger('submit')

    expect(wrapper.emitted('search')).toBeTruthy()
    expect(wrapper.emitted('search')[0]).toEqual(['test query'])
  })
})
```

## Troubleshooting

Common issues and solutions.

### Services Won't Start

**Check logs:**
```bash
mise run logs
```

**Check disk space:**
```bash
df -h
```

**Reset everything:**
```bash
mise run clean
docker system prune -a
mise run up
```

### Database Connection Issues

**Check PostgreSQL health:**
```bash
mise run ps
docker exec -it legalease-postgres pg_isready
```

**Reset database:**
```bash
mise run down
docker volume rm legalease_postgres_data
mise run up
mise run migrate
```

**Verify connection string:**
```bash
# backend/.env
DATABASE_URL=postgresql://legalease:legalease_dev@postgres:5432/legalease
```

### Out of Memory

**Check memory usage:**
```bash
docker stats
```

**Solutions:**
- Increase Docker memory limit in Docker Desktop
- Use smaller AI models (e.g., llama3.1:8b instead of 70b)
- Reduce worker concurrency
- Lower batch sizes in transcription
- Add swap space to host system

**Adjust service limits:**
```yaml
# docker-compose.yml
services:
  worker:
    deploy:
      resources:
        limits:
          memory: 8G
```

### Slow Search Performance

**Check index health:**
```bash
# Verify Qdrant collection
curl http://localhost:6333/collections/documents

# Check PostgreSQL indexes
mise run psql
\di
```

**Optimize:**
- Rebuild indexes if corrupted
- Adjust chunk sizes to reduce total chunks
- Enable query result caching
- Check for slow queries in logs

### Transcription Errors

**Check Whisper model:**
```bash
docker exec -it legalease-worker python -c "from faster_whisper import WhisperModel; print(WhisperModel.list_models())"
```

**CUDA errors:**
```bash
# Check NVIDIA drivers
nvidia-smi

# Verify CUDA is available in container
docker exec -it legalease-worker python -c "import torch; print(torch.cuda.is_available())"
```

**Solutions:**
- Update NVIDIA drivers
- Use CPU-only mode if GPU unavailable
- Reduce batch size for memory issues
- Switch to smaller Whisper model

### Frontend Build Errors

**Clear cache:**
```bash
cd frontend
rm -rf .nuxt node_modules .output
npm install
npm run build
```

**Check Node.js version:**
```bash
node --version  # Should be 20.x or higher
```

**Update dependencies:**
```bash
npm update
```

### Port Conflicts

**Check what's using a port:**
```bash
# Linux/Mac
lsof -i :3000

# Windows
netstat -ano | findstr :3000
```

**Change ports:**
```yaml
# docker-compose.yml
services:
  frontend:
    ports:
      - "3001:3000"  # Use different host port
```

## Contributing

Guidelines for contributing to LegalEase AI.

### Code Style

**Backend (Python):**
- Follow PEP 8 style guide
- Use Black for formatting: `black app/`
- Use isort for imports: `isort app/`
- Use mypy for type checking: `mypy app/`

**Frontend (JavaScript/TypeScript):**
- Use ESLint configuration
- Format with Prettier: `npm run format`
- Follow Vue.js style guide

### Commit Messages

Follow conventional commits:
```
feat: add speaker diarization to transcriptions
fix: resolve PDF viewer zoom issue
docs: update installation guide
chore: upgrade dependencies
test: add tests for hybrid search
```

### Pull Requests

1. Create a feature branch: `git checkout -b feat/your-feature`
2. Make your changes
3. Write or update tests
4. Ensure all tests pass: `mise run test`
5. Commit with descriptive messages
6. Push to your fork
7. Create a pull request with clear description

### Documentation

- Update documentation for new features
- Include examples and use cases
- Add screenshots for UI changes
- Update API documentation for endpoint changes

## Performance Profiling

Identify and resolve performance bottlenecks.

### Backend Profiling

**Profile API endpoints:**
```python
# Use cProfile
import cProfile
import pstats

profiler = cProfile.Profile()
profiler.enable()
# Your code here
profiler.disable()
stats = pstats.Stats(profiler)
stats.sort_stats('cumtime')
stats.print_stats(20)
```

**SQL query profiling:**
```python
# Enable SQL echo
DATABASE_URL=postgresql://...?echo=true
```

**Memory profiling:**
```python
# Use memory_profiler
from memory_profiler import profile

@profile
def process_document(doc_id):
    # Your code here
    pass
```

### Frontend Profiling

**Performance DevTools:**
1. Open Chrome DevTools
2. Go to Performance tab
3. Click Record
4. Perform actions
5. Stop and analyze flame graph

**Lighthouse audit:**
```bash
# Run Lighthouse
npx lighthouse http://localhost:3000
```

**Bundle analysis:**
```bash
# Analyze bundle size
npm run build
npx nuxi analyze
```

## Docker Tips

Useful Docker commands for development.

### Container Management

```bash
# View running containers
docker ps

# View all containers (including stopped)
docker ps -a

# Stop all containers
docker stop $(docker ps -q)

# Remove all containers
docker rm $(docker ps -aq)

# View container logs
docker logs legalease-backend -f

# Execute command in container
docker exec -it legalease-backend bash
```

### Image Management

```bash
# List images
docker images

# Remove unused images
docker image prune

# Remove all images
docker rmi $(docker images -q)

# Build specific service
docker-compose build backend
```

### Volume Management

```bash
# List volumes
docker volume ls

# Remove unused volumes
docker volume prune

# Remove specific volume
docker volume rm legalease_postgres_data

# Inspect volume
docker volume inspect legalease_postgres_data
```

### Network Debugging

```bash
# Inspect network
docker network inspect legalease_default

# Test connectivity between containers
docker exec legalease-backend ping postgres

# Check DNS resolution
docker exec legalease-backend nslookup postgres
```

## Resources

Additional resources for development.

### Documentation

- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Nuxt Documentation](https://nuxt.com/)
- [Nuxt UI Documentation](https://ui.nuxt.com/)
- [SQLAlchemy Documentation](https://www.sqlalchemy.org/)
- [Celery Documentation](https://docs.celeryq.dev/)

### Tools

- [Postman](https://www.postman.com/) - API testing
- [DBeaver](https://dbeaver.io/) - Database management
- [RedisInsight](https://redis.com/redis-enterprise/redis-insight/) - Redis GUI
- [Neo4j Browser](http://localhost:7474) - Graph database UI

### Community

- [GitHub Issues](https://github.com/AlliecatOwO/legalease-ai/issues) - Report bugs
- [GitHub Discussions](https://github.com/AlliecatOwO/legalease-ai/discussions) - Ask questions

For more information, refer to the project's [README.md](https://github.com/AlliecatOwO/legalease-ai) on GitHub.
