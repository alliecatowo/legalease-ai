import{d as se,f as G,D as h,o,s as a,c as T,j as w,w as u,L as t,K as b,_ as ae,T as V,a as l,F as I,G as B,E as ne,M as fe,V as ce,y as ze,C as ue,r as Ue,P as Ae,e as E,U as Ve,N as Q,a2 as de,a3 as me,a4 as pe,J as j,a5 as De,a6 as Re}from"#entry";import{_ as he}from"./C0wxqGeD.js";import{_ as Me}from"./CJ9Ym_Vo.js";import{_ as Ie}from"./jxpb6RCH.js";import{_ as Ne}from"./zGKBPmqO.js";import{_ as ge}from"./DPqesvf7.js";import{_ as ie}from"./CDi83SG1.js";import{_ as ve}from"./BHe7gfhX.js";import{_ as Oe}from"./DlAUqK2U.js";import{_ as Fe}from"./DYPKHOjw.js";import{_ as Ee}from"./CH-Oc00F.js";import{_ as je}from"./B7vB9rem.js";import{_ as Be}from"./Ch8iEGbY.js";import{_ as Le}from"./DK_M2cpq.js";import{u as Pe}from"./CaoxetMn.js";import{u as qe}from"./BehdISRr.js";import{d as Ke}from"./D9A4Js5F.js";import"./Dip1mGGo.js";import"./BSuOfW5l.js";import"./DvYBZqIB.js";import"./sTZnGM-8.js";import"./CHZYgNjC.js";import"./C0IRJ9st.js";import"./U9gof1xZ.js";import"./CGV-9Xko.js";import"./DF6Rzu04.js";import"./CqOTKR6S.js";import"./BMuCWYOq.js";import"./Bc20tCqw.js";import"./BGmxVXu4.js";const Ge={key:0},He={key:1},We={class:"flex flex-col"},Ze={class:"font-medium"},Je={class:"text-xs text-muted"},Ye={key:0},Qe={key:1},Xe={class:"flex items-center gap-2"},et={key:0},tt={key:1},lt={class:"flex items-center gap-2"},st={key:2,class:"flex flex-wrap gap-1.5"},at=se({__name:"SearchFilters",props:{selectedCases:{},selectedDocumentTypes:{},selectedChunkTypes:{},availableCases:{},isCompact:{type:Boolean},showChunkTypes:{type:Boolean}},emits:["update:selectedCases","update:selectedDocumentTypes","update:selectedChunkTypes","clear"],setup(i,{emit:v}){const z=i,q=v,f=G({get:()=>z.availableCases.filter(k=>z.selectedCases.includes(k.id)),set:k=>{const y=Array.isArray(k)?k.map(d=>d.id).filter(d=>d!=null):[];q("update:selectedCases",y)}}),$=G({get:()=>z.selectedDocumentTypes,set:k=>{const y=Array.isArray(k)?k.map(d=>typeof d=="object"?d.value:d):[];q("update:selectedDocumentTypes",y)}}),N=G({get:()=>z.selectedChunkTypes||[],set:k=>{const y=Array.isArray(k)?k.map(d=>typeof d=="object"?d.value:d):[];q("update:selectedChunkTypes",y)}}),O=[{value:"contract",label:"Contracts",icon:"i-lucide-file-text"},{value:"court_filing",label:"Court Filings",icon:"i-lucide-gavel"},{value:"transcript",label:"Transcripts",icon:"i-lucide-mic"},{value:"brief",label:"Briefs",icon:"i-lucide-file-pen"},{value:"motion",label:"Motions",icon:"i-lucide-file-check"},{value:"correspondence",label:"Correspondence",icon:"i-lucide-mail"}],L=[{value:"summary",label:"Summaries",icon:"i-lucide-sparkles"},{value:"section",label:"Sections",icon:"i-lucide-layout"},{value:"microblock",label:"Microblocks",icon:"i-lucide-component"},{value:"paragraph",label:"Paragraphs",icon:"i-lucide-text"},{value:"page",label:"Pages",icon:"i-lucide-file"}],g=G(()=>z.selectedCases.length>0||z.selectedDocumentTypes.length>0||z.selectedChunkTypes&&z.selectedChunkTypes.length>0),m=()=>{q("clear")};return(k,y)=>{const d=ae,x=ge,D=fe,H=ie;return o(),h("div",{class:ne(["flex flex-wrap items-center gap-3",{"gap-2":i.isCompact}])},[a(x,{modelValue:l(f),"onUpdate:modelValue":y[0]||(y[0]=c=>V(f)?f.value=c:null),items:i.availableCases,multiple:"",by:"id",placeholder:i.selectedCases.length>0?`${i.selectedCases.length} case${i.selectedCases.length>1?"s":""}`:"All Cases",ui:{trigger:"inline-flex items-center gap-x-1.5",width:"w-auto min-w-[160px]"}},{label:u(()=>[a(d,{name:"i-lucide-briefcase",class:"size-4"}),i.selectedCases.length===0?(o(),h("span",Ge,"All Cases")):(o(),h("span",He,b(i.selectedCases.length)+" case"+b(i.selectedCases.length>1?"s":""),1))]),option:u(({option:c})=>[t("div",We,[t("span",Ze,b(c.name),1),t("span",Je,b(c.case_number),1)])]),_:1},8,["modelValue","items","placeholder"]),a(x,{modelValue:l($),"onUpdate:modelValue":y[1]||(y[1]=c=>V($)?$.value=c:null),items:O,multiple:"",placeholder:i.selectedDocumentTypes.length>0?`${i.selectedDocumentTypes.length} type${i.selectedDocumentTypes.length>1?"s":""}`:"All Types",ui:{trigger:"inline-flex items-center gap-x-1.5",width:"w-auto min-w-[160px]"},"value-attribute":"value"},{label:u(()=>[a(d,{name:"i-lucide-file-type",class:"size-4"}),i.selectedDocumentTypes.length===0?(o(),h("span",Ye,"All Types")):(o(),h("span",Qe,b(i.selectedDocumentTypes.length)+" type"+b(i.selectedDocumentTypes.length>1?"s":""),1))]),option:u(({option:c})=>[t("div",Xe,[a(d,{name:c.icon,class:"size-4"},null,8,["name"]),t("span",null,b(c.label),1)])]),_:1},8,["modelValue","placeholder"]),i.showChunkTypes?(o(),T(x,{key:0,modelValue:l(N),"onUpdate:modelValue":y[2]||(y[2]=c=>V(N)?N.value=c:null),items:L,multiple:"",placeholder:(i.selectedChunkTypes?.length||0)>0?`${i.selectedChunkTypes?.length} level${(i.selectedChunkTypes?.length||0)>1?"s":""}`:"All Levels",ui:{trigger:"inline-flex items-center gap-x-1.5",width:"w-auto min-w-[160px]"},"value-attribute":"value"},{label:u(()=>[a(d,{name:"i-lucide-layers",class:"size-4"}),(i.selectedChunkTypes?.length||0)===0?(o(),h("span",et,"All Levels")):(o(),h("span",tt,b(i.selectedChunkTypes?.length)+" level"+b((i.selectedChunkTypes?.length||0)>1?"s":""),1))]),option:u(({option:c})=>[t("div",lt,[a(d,{name:c.icon,class:"size-4"},null,8,["name"]),t("span",null,b(c.label),1)])]),_:1},8,["modelValue","placeholder"])):w("",!0),l(g)?(o(),T(D,{key:1,label:"Clear",icon:"i-lucide-x",color:"neutral",variant:"ghost",size:"sm",onClick:m})):w("",!0),!i.isCompact&&l(g)?(o(),h("div",st,[(o(!0),h(I,null,B(i.selectedCases,c=>(o(),T(H,{key:`case-${c}`,label:i.availableCases.find(P=>P.id===c)?.name||`Case #${c}`,color:"primary",variant:"soft",size:"sm",onClick:P=>f.value=i.selectedCases.filter(Z=>Z!==c)},{trailing:u(()=>[a(d,{name:"i-lucide-x",class:"size-3 cursor-pointer"})]),_:1},8,["label","onClick"]))),128)),(o(!0),h(I,null,B(i.selectedDocumentTypes,c=>(o(),T(H,{key:`type-${c}`,label:O.find(P=>P.value===c)?.label||c,color:"secondary",variant:"soft",size:"sm",onClick:P=>$.value=i.selectedDocumentTypes.filter(Z=>Z!==c)},{trailing:u(()=>[a(d,{name:"i-lucide-x",class:"size-3 cursor-pointer"})]),_:1},8,["label","onClick"]))),128)),(o(!0),h(I,null,B(i.selectedChunkTypes||[],c=>(o(),T(H,{key:`chunk-${c}`,label:L.find(P=>P.value===c)?.label||c,color:"info",variant:"soft",size:"sm",onClick:P=>N.value=(i.selectedChunkTypes||[]).filter(Z=>Z!==c)},{trailing:u(()=>[a(d,{name:"i-lucide-x",class:"size-3 cursor-pointer"})]),_:1},8,["label","onClick"]))),128))])):w("",!0)],2)}}}),nt=Object.assign(at,{__name:"SearchFilters"}),it={class:"space-y-3"},ot={class:"flex items-start justify-between gap-3"},rt={class:"flex items-start gap-3 flex-1 min-w-0"},ct={class:"p-2 bg-muted/20 rounded-lg flex-shrink-0"},ut={class:"flex-1 min-w-0"},dt={class:"font-semibold text-highlighted text-lg mb-1 truncate"},mt={class:"flex items-center gap-2 flex-wrap text-xs"},pt={key:0,class:"text-muted"},ft={key:1,class:"text-muted"},ht={class:"text-muted"},gt={key:2,class:"text-muted"},vt={class:"flex-shrink-0"},yt={class:"text-sm text-muted leading-relaxed"},bt=["innerHTML"],xt={key:0,class:"flex flex-wrap gap-2"},_t={class:"flex items-center justify-between pt-2 border-t border-default/50"},kt={class:"flex items-center gap-2 text-xs text-muted"},Ct={class:"flex items-center gap-2"},Tt=se({__name:"SearchResultCard",props:{result:{},query:{}},setup(i){const v=i,z=G(()=>{const g={contract:{icon:"i-lucide-file-text",color:"primary",label:"Contract"},court_filing:{icon:"i-lucide-gavel",color:"error",label:"Court Filing"},transcript:{icon:"i-lucide-mic",color:"warning",label:"Transcript"},brief:{icon:"i-lucide-file-pen",color:"success",label:"Brief"},motion:{icon:"i-lucide-file-check",color:"secondary",label:"Motion"},correspondence:{icon:"i-lucide-mail",color:"info",label:"Correspondence"},document:{icon:"i-lucide-file",color:"neutral",label:"Document"}};return g[v.result.documentType]||g.document}),q={PERSON:"i-lucide-user",ORGANIZATION:"i-lucide-building",LOCATION:"i-lucide-map-pin",DATE:"i-lucide-calendar",MONEY:"i-lucide-dollar-sign",COURT:"i-lucide-landmark",LAW:"i-lucide-scale"},f=G(()=>{try{return new Date(v.result.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return v.result.date}}),$=G(()=>v.result.documentType==="transcript"||v.result.chunkType==="transcript_segment"),N=g=>{const m=Math.floor(g/3600),k=Math.floor(g%3600/60),y=Math.floor(g%60);return m>0?`${m}:${String(k).padStart(2,"0")}:${String(y).padStart(2,"0")}`:`${k}:${String(y).padStart(2,"0")}`},O=()=>{const g={};if($.value){const m=v.result.metadata?.transcription_id||v.result.metadata?.document_id||v.result.id;v.result.metadata?.start_time!==void 0&&(g.t=v.result.metadata.start_time),v.query&&(g.q=v.query),ce({path:`/transcripts/${m}`,query:g});return}v.result.pageNumber&&(g.page=v.result.pageNumber),v.result.metadata?.chunk_id&&(g.chunk=v.result.metadata.chunk_id),v.query&&(g.q=v.query),ce({path:`/documents/${v.result.metadata?.document_id||v.result.id}`,query:g})},L=G(()=>v.result.relevanceScore>=.8?"success":v.result.relevanceScore>=.6?"info":v.result.relevanceScore>=.4?"warning":"neutral");return(g,m)=>{const k=ae,y=ie,d=he,x=ve;return o(),T(x,{class:"search-result-card cursor-pointer hover:shadow-lg transition-all duration-200 hover:border-primary/50",onClick:O},{default:u(()=>[t("div",it,[t("div",ot,[t("div",rt,[t("div",ct,[a(k,{name:l(z).icon,class:ne(["size-5",`text-${l(z).color}`])},null,8,["name","class"])]),t("div",ut,[t("h3",dt,b(i.result.title),1),t("div",mt,[a(y,{label:l(z).label,color:l(z).color,variant:"soft",size:"sm"},null,8,["label","color"]),l($)?(o(),h(I,{key:0},[i.result.metadata?.speaker?(o(),T(y,{key:0,label:i.result.metadata.speaker,color:"info",variant:"soft",size:"sm"},{leading:u(()=>[a(k,{name:"i-lucide-user",class:"size-3"})]),_:1},8,["label"])):w("",!0),i.result.metadata?.start_time!==void 0?(o(),T(y,{key:1,label:N(i.result.metadata.start_time),color:"neutral",variant:"outline",size:"sm"},{leading:u(()=>[a(k,{name:"i-lucide-clock",class:"size-3"})]),_:1},8,["label"])):w("",!0)],64)):(o(),h(I,{key:1},[i.result.chunkType?(o(),h("span",pt,b(i.result.chunkType),1)):w("",!0),i.result.pageNumber?(o(),h("span",ft,"Page "+b(i.result.pageNumber),1)):w("",!0)],64)),t("span",ht,b(l(f)),1),i.result.jurisdiction?(o(),h("span",gt,b(i.result.jurisdiction),1)):w("",!0)])])]),t("div",vt,[a(d,{text:`Relevance: ${(i.result.relevanceScore*100).toFixed(0)}%`},{default:u(()=>[a(y,{label:`${(i.result.relevanceScore*100).toFixed(0)}%`,color:l(L),variant:"subtle",size:"sm"},null,8,["label","color"])]),_:1},8,["text"])])]),t("div",yt,[t("div",{innerHTML:i.result.excerpt},null,8,bt)]),i.result.entities&&i.result.entities.length>0?(o(),h("div",xt,[(o(!0),h(I,null,B(i.result.entities.slice(0,5),(D,H)=>(o(),T(y,{key:H,label:D.text,color:"neutral",variant:"outline",size:"sm"},{leading:u(()=>[a(k,{name:q[D.type]||"i-lucide-tag",class:"size-3"},null,8,["name"])]),_:2},1032,["label"]))),128)),i.result.entities.length>5?(o(),T(y,{key:0,label:`+${i.result.entities.length-5} more`,color:"neutral",variant:"soft",size:"sm"},null,8,["label"])):w("",!0)])):w("",!0),t("div",_t,[t("div",kt,[a(k,{name:"i-lucide-file",class:"size-3"}),t("span",null,b(i.result.filename||"Document"),1)]),t("div",Ct,[i.result.vectorType?(o(),T(y,{key:0,label:i.result.vectorType==="bm25"?"Keyword":"Semantic",color:i.result.vectorType==="bm25"?"warning":"primary",variant:"soft",size:"sm"},null,8,["label","color"])):w("",!0),a(k,{name:"i-lucide-arrow-right",class:"size-4 text-muted"})])])])]),_:1})}}}),$t=Object.assign(Oe(Tt,[["__scopeId","data-v-3d775f5a"]]),{__name:"SearchResultCard"}),wt={base:"w-full max-w-(--ui-container) mx-auto px-4 sm:px-6 lg:px-8"},St={__name:"UContainer",props:{as:{type:null,required:!1},class:{type:null,required:!1}},setup(i){const v=i,z=ze(),q=G(()=>ue({extend:ue(wt),...z.ui?.container||{}}));return(f,$)=>(o(),T(l(Ae),{as:i.as,class:ne(q.value({class:v.class}))},{default:u(()=>[Ue(f.$slots,"default")]),_:3},8,["as","class"]))}},zt={class:"flex items-center gap-2"},Ut={class:"flex h-full"},At={class:"flex-1 overflow-y-auto"},Vt={class:"flex items-center justify-center min-h-full px-6 py-12"},Dt={class:"w-full max-w-5xl mx-auto text-center space-y-12"},Rt={class:"flex items-center justify-center gap-5 overflow-visible"},Mt={class:"w-full max-w-5xl mx-auto space-y-6"},It={class:"flex justify-center"},Nt={class:"flex flex-wrap justify-center gap-2 mt-6"},Ot={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-16"},Ft={class:"p-6"},Et={class:"mb-6 space-y-3"},jt={key:0,class:"mb-6 flex items-center gap-3 flex-wrap"},Bt={class:"text-sm text-muted"},Lt={class:"font-semibold text-highlighted"},Pt={class:"space-y-4 max-w-5xl"},qt={key:1,class:"text-center py-20"},Kt={class:"text-muted mb-6 max-w-md mx-auto"},Gt={class:"flex flex-wrap justify-center gap-2"},Ht={key:2,class:"flex flex-col items-center justify-center py-20"},Wt={class:"text-sm text-dimmed mt-2"},Zt={key:0,class:"w-80 border-l border-default bg-default overflow-y-auto p-6"},Jt={class:"space-y-6"},Yt={class:"font-medium"},Qt={class:"text-xs text-muted"},Xt={class:"flex items-center justify-between mt-1"},el={class:"text-xs text-muted"},tl={class:"space-y-2 max-h-48 overflow-y-auto"},ll={class:"flex flex-col"},sl={class:"font-medium text-sm"},al={class:"text-xs text-muted"},nl={key:0,class:"text-sm text-muted py-2"},il={class:"space-y-2"},ol={class:"flex items-center gap-2"},rl={class:"space-y-2"},cl={class:"flex flex-col"},ul={class:"font-medium"},dl={class:"text-xs text-muted"},ml={class:"flex items-center gap-2"},pl={key:1,class:"space-y-2"},fl={class:"flex items-center justify-between"},hl={class:"flex flex-wrap gap-1.5"},gl={class:"flex items-start gap-2"},Hl=se({__name:"search",async setup(i){let v,z;const q=Pe(),f=E(""),$=E([]),N=E(!1),O=E(!1),L=E(!1),g=E("hybrid"),m=E({use_bm25:!0,use_dense:!0,fusion_method:"rrf",top_k:50,score_threshold:0,chunk_types:[],document_ids:[],case_ids:[]}),{cases:k}=qe();[v,z]=Ve(()=>k.get()),await v,z();const y=G(()=>(k.data.value?.cases||[]).map(n=>({id:Number(n.id),name:n.name,label:n.name,case_number:n.case_number}))),d=E([]),x=E([]);E([]);const D=E(!0),H=[{value:"contract",label:"Contracts",icon:"i-lucide-file-text"},{value:"court_filing",label:"Court Filings",icon:"i-lucide-gavel"},{value:"transcript",label:"Transcripts",icon:"i-lucide-mic"},{value:"brief",label:"Briefs",icon:"i-lucide-file-pen"},{value:"motion",label:"Motions",icon:"i-lucide-file-check"},{value:"correspondence",label:"Correspondence",icon:"i-lucide-mail"}],c=E([]),P=[{value:"summary",label:"Summaries",description:"Document overviews"},{value:"section",label:"Sections",description:"Major document sections"},{value:"microblock",label:"Microblocks",description:"Detailed paragraphs"},{value:"paragraph",label:"Paragraphs",description:"Individual paragraphs"},{value:"page",label:"Pages",description:"Full pages"},{value:"transcript_segment",label:"Transcript Segments",description:"Audio/video transcript snippets"}];Q(g,n=>{n==="hybrid"?(m.value.use_bm25=!0,m.value.use_dense=!0):n==="semantic"?(m.value.use_bm25=!1,m.value.use_dense=!0):n==="keyword"&&(m.value.use_bm25=!0,m.value.use_dense=!1),f.value.trim()&&X()});const Z=async()=>{if(!f.value.trim()){$.value=[],O.value=!1;return}N.value=!0,O.value=!0;try{const n=d.value.filter(r=>r!=null).map(r=>Number(r)),e=[...c.value];x.value.includes("transcript")&&(e.includes("transcript_segment")||e.push("transcript_segment"));const _={query:f.value,use_bm25:m.value.use_bm25,use_dense:m.value.use_dense,fusion_method:m.value.fusion_method,top_k:m.value.top_k,score_threshold:m.value.score_threshold>0?m.value.score_threshold:void 0,chunk_types:e.length>0?e:void 0,case_ids:n.length>0?n:void 0,document_ids:m.value.document_ids.length>0?m.value.document_ids:void 0};console.log("ðŸ” Search Request Debug:"),console.log("  selectedCases.value:",d.value),console.log("  selectedChunkTypes.value:",c.value),console.log("  Full request object:",JSON.stringify(_,null,2));let M=(await q.search.hybrid(_)).results||[];(x.value.length>0||!D.value)&&(M=M.filter(r=>{const C=oe(r),A=r.metadata?.chunk_type;return!(!D.value&&(C==="transcript"||A==="transcript_segment")||x.value.length>0&&!x.value.includes(C))}));const p=M.map(r=>({id:r.id,title:be(r),excerpt:_e(r),documentType:oe(r),date:r.metadata?.created_at||r.metadata?.uploaded_at||new Date().toISOString(),jurisdiction:r.metadata?.jurisdiction||null,relevanceScore:r.score,entities:ye(r.metadata),caseNumber:r.metadata?.case_id?`Case #${r.metadata.case_id}`:null,metadata:r.metadata,highlights:r.highlights,vectorType:r.vector_type,chunkType:r.metadata?.chunk_type,pageNumber:r.metadata?.page_number,filename:r.metadata?.filename}));$.value=p}catch(n){console.error("Search error:",n),$.value=[]}finally{N.value=!1,O.value=!1}};function oe(n){if(n.metadata?.chunk_type==="transcript_segment")return"transcript";if(n.metadata?.document_type)return n.metadata.document_type;const e=(n.metadata?.filename||"").toLowerCase();return e.includes("contract")||e.includes("agreement")?"contract":e.includes("filing")||e.includes("complaint")?"court_filing":e.includes("transcript")?"transcript":e.includes("brief")?"brief":e.includes("motion")?"motion":e.includes("email")||e.includes("letter")?"correspondence":n.metadata?.chunk_type||"document"}function ye(n){if(!n)return[];const e=[];return n.entities&&Array.isArray(n.entities)&&e.push(...n.entities),n.parties&&Array.isArray(n.parties)&&n.parties.forEach(_=>{e.push({type:"PERSON",text:_})}),n.court&&e.push({type:"COURT",text:n.court}),n.filing_date&&e.push({type:"DATE",text:new Date(n.filing_date).toLocaleDateString()}),e}function be(n){const e=n.metadata||{};if(e.chunk_type==="transcript_segment"){const r=e.speaker||"Unknown Speaker",C=e.title||e.filename||"Transcript";return`${r} - ${C}`}if(e.title&&e.title.length>3)return e.title;if(e.filename){const C=e.filename.replace(/\.(pdf|docx?|txt)$/i,"").replace(/_/g," ").replace(/\d{4}-\d{2}-\d{2}/g,"").replace(/\s+/g," ").trim();if(C.length>3)return C}const S=(n.text||"").split(`
`).filter(r=>r.trim());if(S.length>0){const r=S[0].trim(),C=/^(AGREEMENT|CONTRACT|NOTICE|LETTER|MEMORANDUM|MEMO|REPORT|ORDER|MOTION|BRIEF|COMPLAINT|PETITION|AFFIDAVIT|DECLARATION|DEPOSITION|TRANSCRIPT)/i;if(r.length<150){if(C.test(r))return r;const A=r===r.toUpperCase()&&r.length>5,U=/^[A-Z][a-z]+(?: [A-Z][a-z]+)*/.test(r);if(A||U)return r}if(S.length>1&&r.length<30){const A=S[1].trim();if(A.length>10&&A.length<150)return`${r} - ${A}`}}const M=e.chunk_type||"Section",p=e.document_id||n.id;return`${M.charAt(0).toUpperCase()+M.slice(1)} from Document #${p}`}function xe(n){const e=Math.floor(n/3600),_=Math.floor(n%3600/60),S=Math.floor(n%60);return e>0?`${e}:${String(_).padStart(2,"0")}:${String(S).padStart(2,"0")}`:`${_}:${String(S).padStart(2,"0")}`}function _e(n){const e=n.metadata||{};if(e.chunk_type==="transcript_segment"){const r=n.text||n.highlights?.[0]||"",C=e.start_time!==void 0?`[${xe(e.start_time)}] `:"",A=r.length>300?r.substring(0,300)+"...":r,U=n.vector_type==="bm25"||g.value==="keyword",F=n.vector_type!=="bm25"||g.value==="semantic",J=te(A,f.value,U,F);return C+J}const _=n.vector_type==="bm25"||g.value==="keyword",S=n.vector_type!=="bm25"||g.value==="semantic";if(n.highlights&&n.highlights.length>0)return n.highlights.slice(0,3).map(r=>te(r,f.value,_,S)).join(' <span class="text-dimmed">...</span> ');const M=n.text||"",p=ke(M,f.value);return p?te(p,f.value,_,S):'<span class="text-muted italic">No preview available</span>'}function ke(n,e,_=400){if(!n)return"";const S=e.toLowerCase().split(/\s+/).filter(F=>F.length>2);if(S.length===0)return n.substring(0,_).trim()+(n.length>_?"...":"");const M=n.toLowerCase();let p=-1,r="";for(const F of S){const J=M.indexOf(F);J!==-1&&(p===-1||J<p)&&(p=J,r=F)}if(p===-1)return n.substring(0,_).trim()+(n.length>_?"...":"");const C=Math.max(0,p-100),A=Math.min(n.length,p+r.length+300);let U=n.substring(C,A).trim();return C>0&&(U="..."+U),A<n.length&&(U=U+"..."),U}function te(n,e,_,S){if(!e)return n;const M=e.toLowerCase().split(/\s+/);let p=n;const r=C=>C.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return M.forEach(C=>{if(C.length>2){const A=r(C),U=new RegExp(`(${A})`,"gi");_&&!S?p=p.replace(U,'<mark class="bg-warning/30 text-warning-600 dark:text-warning-400 font-medium px-0.5 rounded">$1</mark>'):S&&!_?p=p.replace(U,'<mark class="bg-primary/20 text-primary-600 dark:text-primary-400 font-medium px-0.5 rounded">$1</mark>'):p=p.replace(U,'<mark class="bg-gradient-to-r from-warning/30 to-primary/20 text-highlighted font-semibold px-0.5 rounded">$1</mark>')}}),p}const X=De(Z,300);Q(f,()=>{f.value.trim()&&(O.value=!0),X()}),Q([d,c,x,D],()=>{f.value.trim()&&X()},{deep:!0}),Q(()=>[m.value.score_threshold,m.value.fusion_method,m.value.top_k],()=>{f.value.trim()&&X()});const re=de("heroSearchInput"),le=de("compactSearchInput"),Ce=()=>{$.value.length>0||O.value?le.value?.inputRef?.focus():re.value?.inputRef?.focus()};return Q([$,O],([n,e])=>{(e||n.length>0)&&Re(()=>{le.value?.inputRef?.focus()})}),Ke({"/":{usingInput:!1,handler:()=>{Ce()}},meta_k:{usingInput:!0,handler:()=>{L.value=!L.value}}}),(n,e)=>{const _=fe,S=he,M=Me,p=ae,r=Ie,C=Ne,A=nt,U=ve,F=ie,J=$t,Te=St,K=Fe,$e=Ee,W=je,we=ge,ee=Be,Se=Le;return o(),T(Se,null,{header:u(()=>[a(M,{title:l($).length>0?`Search Results (${l($).length})`:"Search"},{trailing:u(()=>[t("div",zt,[a(S,{text:"Search Settings (âŒ˜K)"},{default:u(()=>[a(_,{icon:"i-lucide-settings",color:"neutral",variant:l(L)?"soft":"ghost",onClick:e[0]||(e[0]=s=>L.value=!l(L))},null,8,["variant"])]),_:1})])]),_:1},8,["title"])]),body:u(()=>[t("div",Ut,[t("div",At,[me(t("div",Vt,[t("div",Dt,[t("div",Rt,[a(p,{name:"i-lucide-scale",class:"size-20 text-primary shrink-0"}),e[24]||(e[24]=t("h1",{class:"text-7xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent tracking-tight leading-tight pb-2"}," LegalEase AI ",-1))]),e[31]||(e[31]=t("p",{class:"text-xl text-muted max-w-2xl mx-auto"}," Intelligent hybrid search across your legal documents, contracts, and case files ",-1)),t("div",Mt,[a(C,{ref_key:"heroSearchInput",ref:re,modelValue:l(f),"onUpdate:modelValue":e[1]||(e[1]=s=>V(f)?f.value=s:null),icon:"i-lucide-search",placeholder:"Search for legal terms, clauses, concepts, or natural language queries...",size:"xl",loading:l(N),autofocus:"",class:"!text-lg shadow-xl hover:shadow-2xl transition-shadow",ui:{base:"px-6 py-5 text-lg rounded-2xl",leadingIcon:"size-7"}},{trailing:u(()=>[a(r,{value:"/"})]),_:1},8,["modelValue","loading"]),t("div",It,[a(A,{"selected-cases":l(d),"onUpdate:selectedCases":e[2]||(e[2]=s=>V(d)?d.value=s:null),"selected-document-types":l(x),"onUpdate:selectedDocumentTypes":e[3]||(e[3]=s=>V(x)?x.value=s:null),"selected-chunk-types":l(c),"onUpdate:selectedChunkTypes":e[4]||(e[4]=s=>V(c)?c.value=s:null),"available-cases":l(y),"show-chunk-types":!0,onClear:e[5]||(e[5]=s=>{d.value=[],x.value=[],c.value=[]})},null,8,["selected-cases","selected-document-types","selected-chunk-types","available-cases"])])]),t("div",Nt,[(o(),h(I,null,B(["indemnification clauses","force majeure","non-compete agreements","intellectual property rights"],s=>a(_,{key:s,label:s,color:"neutral",variant:"outline",size:"xs",onClick:R=>f.value=s},null,8,["label","onClick"])),64))]),t("div",Ot,[a(U,{ui:{body:"space-y-3"}},{default:u(()=>[a(p,{name:"i-lucide-zap",class:"size-8 text-primary"}),e[25]||(e[25]=t("h3",{class:"font-semibold text-lg"},"Semantic Search",-1)),e[26]||(e[26]=t("p",{class:"text-sm text-muted"}," Find documents by meaning and context, not just exact keywords ",-1))]),_:1}),a(U,{ui:{body:"space-y-3"}},{default:u(()=>[a(p,{name:"i-lucide-target",class:"size-8 text-primary"}),e[27]||(e[27]=t("h3",{class:"font-semibold text-lg"},"Entity Recognition",-1)),e[28]||(e[28]=t("p",{class:"text-sm text-muted"}," Automatic identification of parties, dates, amounts, and legal citations ",-1))]),_:1}),a(U,{ui:{body:"space-y-3"}},{default:u(()=>[a(p,{name:"i-lucide-sparkles",class:"size-8 text-primary"}),e[29]||(e[29]=t("h3",{class:"font-semibold text-lg"},"AI-Powered",-1)),e[30]||(e[30]=t("p",{class:"text-sm text-muted"}," Advanced language models trained on legal corpus for accuracy ",-1))]),_:1})])])],512),[[pe,l($).length===0&&!l(O)]]),me(t("div",Ft,[a(Te,null,{default:u(()=>[t("div",Et,[a(C,{ref_key:"compactSearchInput",ref:le,modelValue:l(f),"onUpdate:modelValue":e[7]||(e[7]=s=>V(f)?f.value=s:null),icon:"i-lucide-search",placeholder:"Search for legal terms, clauses, concepts...",size:"lg",loading:l(N)},{trailing:u(()=>[l(f)?(o(),T(_,{key:0,icon:"i-lucide-x",color:"neutral",variant:"ghost",size:"xs",onClick:e[6]||(e[6]=s=>f.value="")})):w("",!0)]),_:1},8,["modelValue","loading"]),a(A,{"selected-cases":l(d),"onUpdate:selectedCases":e[8]||(e[8]=s=>V(d)?d.value=s:null),"selected-document-types":l(x),"onUpdate:selectedDocumentTypes":e[9]||(e[9]=s=>V(x)?x.value=s:null),"selected-chunk-types":l(c),"onUpdate:selectedChunkTypes":e[10]||(e[10]=s=>V(c)?c.value=s:null),"available-cases":l(y),"show-chunk-types":!0,"is-compact":!0,onClear:e[11]||(e[11]=s=>{d.value=[],x.value=[],c.value=[]})},null,8,["selected-cases","selected-document-types","selected-chunk-types","available-cases"])]),l($).length>0?(o(),h("div",jt,[t("p",Bt,[e[32]||(e[32]=j(" About ",-1)),t("span",Lt,b(l($).length),1),e[33]||(e[33]=j(" results ",-1))]),a(F,{label:l(g),color:"primary",variant:"soft",size:"sm"},null,8,["label"]),l(m).fusion_method!=="rrf"?(o(),T(F,{key:0,label:`Fusion: ${l(m).fusion_method}`,color:"neutral",variant:"outline",size:"sm"},null,8,["label"])):w("",!0)])):w("",!0),t("div",Pt,[(o(!0),h(I,null,B(l($),s=>(o(),T(J,{key:`${s.id}-${s.metadata?.chunk_id||s.pageNumber}`,result:s,query:l(f)},null,8,["result","query"]))),128))]),l($).length===0&&!l(N)&&l(f)?(o(),h("div",qt,[a(p,{name:"i-lucide-search-x",class:"size-20 text-muted mx-auto mb-6 opacity-30"}),e[34]||(e[34]=t("h3",{class:"text-2xl font-semibold mb-3 text-highlighted"},"No results found",-1)),t("p",Kt,` We couldn't find any documents matching "`+b(l(f))+'". Try different keywords or switch search modes. ',1),t("div",Gt,[a(_,{label:"Try semantic search",icon:"i-lucide-sparkles",color:"neutral",variant:"outline",onClick:e[12]||(e[12]=s=>g.value="semantic")}),a(_,{label:"View all documents",icon:"i-lucide-folder",color:"neutral",to:"/documents"})])])):w("",!0),l(N)?(o(),h("div",Ht,[a(p,{name:"i-lucide-loader-circle",class:"size-12 text-primary animate-spin mb-4"}),e[35]||(e[35]=t("p",{class:"text-muted"},"Searching through documents...",-1)),t("p",Wt,"Using "+b(l(g))+" search with "+b(l(m).fusion_method.toUpperCase())+" fusion",1)])):w("",!0)]),_:1})],512),[[pe,l($).length>0||l(O)]])]),l(L)?(o(),h("div",Zt,[t("div",Jt,[e[39]||(e[39]=t("div",null,[t("h3",{class:"font-semibold text-lg mb-1"},"Search Settings"),t("p",{class:"text-sm text-muted"},"Configure your search parameters")],-1)),a(K),a(W,{label:"Search Mode",help:"Choose how to search your documents"},{default:u(()=>[a($e,{modelValue:l(g),"onUpdate:modelValue":e[13]||(e[13]=s=>V(g)?g.value=s:null),options:[{value:"hybrid",label:"Hybrid Search",description:"BM25 + Semantic (Recommended)"},{value:"semantic",label:"Semantic Only",description:"AI-powered meaning-based search"},{value:"keyword",label:"Keyword Only",description:"Traditional BM25 keyword matching"}],ui:{fieldset:"space-y-3"}},{label:u(({option:s})=>[t("div",null,[t("p",Yt,b(s.label),1),t("p",Qt,b(s.description),1)])]),_:1},8,["modelValue"])]),_:1}),a(K),l(g)==="hybrid"?(o(),T(W,{key:0,label:"Fusion Method",help:"How to combine BM25 and semantic results"},{default:u(()=>[a(we,{modelValue:l(m).fusion_method,"onUpdate:modelValue":e[14]||(e[14]=s=>l(m).fusion_method=s),options:[{value:"rrf",label:"RRF (Reciprocal Rank Fusion)"},{value:"weighted",label:"Weighted Combination"},{value:"max",label:"Maximum Score"}],"value-attribute":"value"},null,8,["modelValue"])]),_:1})):w("",!0),a(W,{label:"Results Limit",help:"Maximum number of results to return"},{default:u(()=>[a(C,{modelValue:l(m).top_k,"onUpdate:modelValue":e[15]||(e[15]=s=>l(m).top_k=s),modelModifiers:{number:!0},type:"number",min:"5",max:"100",step:"5"},null,8,["modelValue"])]),_:1}),a(K),a(W,{label:"Confidence Threshold",help:"Filter results below this score (0.0 = show all)"},{help:u(()=>[t("div",Xt,[t("span",el,"Current: "+b((Number(l(m).score_threshold)||0).toFixed(2)),1),Number(l(m).score_threshold)>0?(o(),T(_,{key:0,label:"Reset",size:"2xs",color:"neutral",variant:"ghost",onClick:e[17]||(e[17]=s=>l(m).score_threshold=0)})):w("",!0)])]),default:u(()=>[a(C,{modelValue:l(m).score_threshold,"onUpdate:modelValue":e[16]||(e[16]=s=>l(m).score_threshold=s),modelModifiers:{number:!0},type:"number",min:"0",max:"1",step:"0.05",placeholder:"0.0"},null,8,["modelValue"])]),_:1}),a(K),a(K),a(W,{label:"Cases",help:"Filter results by specific cases"},{default:u(()=>[t("div",tl,[(o(!0),h(I,null,B(l(y),s=>(o(),T(ee,{key:s.id,modelValue:l(d),"onUpdate:modelValue":e[18]||(e[18]=R=>V(d)?d.value=R:null),value:s.id},{label:u(()=>[t("div",ll,[t("span",sl,b(s.name),1),t("span",al,b(s.case_number),1)])]),_:2},1032,["modelValue","value"]))),128)),l(y).length===0?(o(),h("div",nl," No cases available ")):w("",!0)])]),_:1}),a(K),a(W,{label:"Document Types",help:"Filter results by document type"},{default:u(()=>[t("div",il,[(o(),h(I,null,B(H,s=>a(ee,{key:s.value,modelValue:l(x),"onUpdate:modelValue":e[19]||(e[19]=R=>V(x)?x.value=R:null),value:s.value,label:s.label},{label:u(()=>[t("div",ol,[a(p,{name:s.icon,class:"size-4"},null,8,["name"]),t("span",null,b(s.label),1)])]),_:2},1032,["modelValue","value","label"])),64))])]),_:1}),a(K),a(W,{label:"Content Granularity",help:"Filter by content chunk size"},{default:u(()=>[t("div",rl,[(o(),h(I,null,B(P,s=>a(ee,{key:s.value,modelValue:l(c),"onUpdate:modelValue":e[20]||(e[20]=R=>V(c)?c.value=R:null),value:s.value},{label:u(()=>[t("div",cl,[t("span",ul,b(s.label),1),t("span",dl,b(s.description),1)])]),_:2},1032,["modelValue","value"])),64))])]),_:1}),a(K),a(W,{label:"Transcripts",help:"Include or exclude audio transcripts from search results"},{default:u(()=>[a(ee,{modelValue:l(D),"onUpdate:modelValue":e[21]||(e[21]=s=>V(D)?D.value=s:null),label:"Include Transcripts in Results"},{label:u(()=>[t("div",ml,[a(p,{name:"i-lucide-mic",class:"size-4"}),e[36]||(e[36]=t("span",null,"Include Transcripts",-1))])]),_:1},8,["modelValue"])]),_:1}),a(K),l(d).length>0||l(x).length>0||l(c).length>0||!l(D)?(o(),h("div",pl,[t("div",fl,[e[37]||(e[37]=t("span",{class:"text-sm font-medium text-highlighted"},"Active Filters",-1)),a(_,{label:"Clear All",color:"neutral",variant:"ghost",size:"xs",onClick:e[22]||(e[22]=s=>{d.value=[],x.value=[],c.value=[],D.value=!0})})]),t("div",hl,[(o(!0),h(I,null,B(l(d),s=>(o(),T(F,{key:s,label:l(y).find(R=>R.id===s)?.name||`Case #${s}`,color:"secondary",variant:"soft",size:"sm",onClick:R=>d.value=l(d).filter(Y=>Y!==s)},{trailing:u(()=>[a(p,{name:"i-lucide-x",class:"size-3 cursor-pointer"})]),_:1},8,["label","onClick"]))),128)),(o(!0),h(I,null,B(l(x),s=>(o(),T(F,{key:s,label:H.find(R=>R.value===s)?.label||s,color:"primary",variant:"soft",size:"sm",onClick:R=>x.value=l(x).filter(Y=>Y!==s)},{trailing:u(()=>[a(p,{name:"i-lucide-x",class:"size-3 cursor-pointer"})]),_:1},8,["label","onClick"]))),128)),(o(!0),h(I,null,B(l(c),s=>(o(),T(F,{key:s,label:P.find(R=>R.value===s)?.label||s,color:"info",variant:"soft",size:"sm",onClick:R=>c.value=l(c).filter(Y=>Y!==s)},{trailing:u(()=>[a(p,{name:"i-lucide-x",class:"size-3 cursor-pointer"})]),_:1},8,["label","onClick"]))),128)),l(D)?w("",!0):(o(),T(F,{key:0,label:"Exclude Transcripts",color:"warning",variant:"soft",size:"sm",onClick:e[23]||(e[23]=s=>D.value=!0)},{leading:u(()=>[a(p,{name:"i-lucide-mic-off",class:"size-3"})]),trailing:u(()=>[a(p,{name:"i-lucide-x",class:"size-3 cursor-pointer"})]),_:1}))])])):w("",!0),a(K),a(U,{ui:{body:"space-y-2"}},{default:u(()=>[t("div",gl,[a(p,{name:"i-lucide-info",class:"size-5 text-primary shrink-0 mt-0.5"}),e[38]||(e[38]=t("div",{class:"text-sm"},[t("p",{class:"font-medium text-highlighted mb-1"},"Search Tips"),t("ul",{class:"text-muted space-y-1 text-xs"},[t("li",null,[j("â€¢ Use "),t("strong",null,"hybrid"),j(" for best results")]),t("li",null,[j("â€¢ Try "),t("strong",null,"semantic"),j(" for concept searches")]),t("li",null,[j("â€¢ Use "),t("strong",null,"keyword"),j(" for exact terms")]),t("li",null,[j("â€¢ "),t("span",{class:"bg-warning/30 px-1 rounded"},"Yellow"),j(" = Keyword match")]),t("li",null,[j("â€¢ "),t("span",{class:"bg-primary/20 px-1 rounded"},"Blue"),j(" = Semantic match")])])],-1))])]),_:1})])])):w("",!0)])]),_:1})}}});export{Hl as default};
